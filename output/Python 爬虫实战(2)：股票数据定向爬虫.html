<!DOCTYPE html>
            <html><head><meta charset="UTF-8">
            </head><body>
            <p><a href="http://python.jobbole.com/88350/">原文链接</a></p>
            <p><center><h1>Python 爬虫实战(2)：股票数据定向爬虫</h1></center></p>
                <div class="entry">
<div class="copyright-area">原文出处： <a href="https://segmentfault.com/a/1190000010520835" target="_blank">hang</a>   </div><h1>功能简介</h1>
<p><strong>目标：</strong> 获取上交所和深交所所有股票的名称和交易信息。<br/>
<strong>输出：</strong> 保存到文件中。<br/>
<strong>技术路线：</strong> <span style="color: #ff0000"><strong>requests—bs4–re</strong></span><br/>
<strong>语言：python3.5</strong></p>
<h2>说明</h2>
<p><strong>网站选择原则：</strong> 股票信息静态存在于html页面中，非js代码生成，没有Robbts协议限制。<br/>
<strong>选取方法：</strong> 打开网页，查看源代码，搜索网页的股票价格数据是否存在于源代码中。<br/>
如打开新浪股票网址：<a href="http://finance.sina.com.cn/realstock/company/sz000877/nc.shtml">链接描述</a>，如下图所示：</p>
<p><a href="http://jbcdn2.b0.upaiyun.com/2017/08/6b30322fa6b042eff6d3f60a95b8220b.png"><img alt="134531uhe4siy48m1t4goo" class="aligncenter wp-image-88351 size-full" height="146" src="http://jbcdn2.b0.upaiyun.com/2017/08/6b30322fa6b042eff6d3f60a95b8220b.png" width="609"/></a></p>
<p>上图中左边为网页的界面，显示了天山股份的股票价格是13.06。右边为该网页的源代码，在源代码中查询13.06发现没有找到。所以判断该网页的数据使用js生成的，不适合本项目。因此换一个网页。</p>
<p>再打开百度股票的网址：<a href="https://gupiao.baidu.com/stock/sz300023.html">链接描述</a>，如下图所示：</p>
<p><a href="http://jbcdn2.b0.upaiyun.com/2017/08/aad76450e2f545d67619659a71a420fc.png"><img alt="134531uhe4siy48m1t4goo" class="aligncenter wp-image-88352 size-full" height="94" src="http://jbcdn2.b0.upaiyun.com/2017/08/aad76450e2f545d67619659a71a420fc.png" width="670"/></a></p>
<p>从上图中可以发现百度股票的数据是html代码生成的，符合我们本项目的要求，所以在本项目中选择百度股票的网址。</p>
<p>由于百度股票只有单个股票的信息，所以还需要当前股票市场中所有股票的列表，在这里我们选择东方财富网，网址为：<a href="http://quote.eastmoney.com/stocklist.html">链接描述</a>，界面如下图所示：</p>
<p><a href="http://jbcdn2.b0.upaiyun.com/2017/08/79e952720ce03bff5b28e3092edba336.png"><img alt="134531uhe4siy48m1t4goo" class="aligncenter wp-image-88353 size-full" height="224" src="http://jbcdn2.b0.upaiyun.com/2017/08/79e952720ce03bff5b28e3092edba336.png" width="666"/></a></p>
<h1>原理分析</h1>
<p>查看百度股票每只股票的网址：<span style="color: #ff0000"><strong>https://gupiao.baidu.com/stock/sz300023.html</strong></span>，可以发现网址中有一个编号<span style="color: #ff0000"><strong>300023</strong></span>正好是这只股票的编号，<span style="color: #ff0000"><strong>sz</strong></span>表示的深圳交易所。因此我们构造的程序结构如下：</p>
<ul>
<li><strong>步骤1：</strong> 从东方财富网获取股票列表；</li>
<li><strong>步骤2：</strong> 逐一获取股票代码，并增加到百度股票的链接中，最后对这些链接进行逐个的访问获得股票的信息；</li>
<li><strong>步骤3：</strong> 将结果存储到文件。</li>
</ul>
<p>接着查看百度个股信息网页的源代码，发现每只股票的信息在html代码中的存储方式如下：</p>
<p><a href="http://jbcdn2.b0.upaiyun.com/2017/08/a5d61524f2de99088419b3ec5740a3b6.png"><img alt="134531uhe4siy48m1t4goo" class="aligncenter wp-image-88354 size-full" height="216" src="http://jbcdn2.b0.upaiyun.com/2017/08/a5d61524f2de99088419b3ec5740a3b6.png" width="417"/></a></p>
<p>因此，在我们存储每只股票的信息时，可以参考上图中html代码的存储方式。每一个信息源对应一个信息值，即采用键值对的方式进行存储。在python中键值对的方式可以用<strong>字典</strong>类型。因此，在本项目中，使用字典来存储每只股票的信息，然后再用字典把所有股票的信息记录起来，最后将字典中的数据输出到文件中。</p>
<h1>代码编写</h1>
<p><span style="color: #ff0000"><strong>首先是获得html网页数据的程序</strong></span>，在这里不多做介绍了，代码如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d093667480369" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
#获得html文本
def getHTMLText(url):
    try:
        r = requests.get(url)
        r.raise_for_status()
        r.encoding = r.apparent_encoding
        return r.text
    except:
        return ""</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d093667480369-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d093667480369-2">2</div><div class="crayon-num" data-line="crayon-5bac8ede7d093667480369-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d093667480369-4">4</div><div class="crayon-num" data-line="crayon-5bac8ede7d093667480369-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d093667480369-6">6</div><div class="crayon-num" data-line="crayon-5bac8ede7d093667480369-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d093667480369-8">8</div><div class="crayon-num" data-line="crayon-5bac8ede7d093667480369-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d093667480369-1"><span class="crayon-c">#获得html文本</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d093667480369-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">getHTMLText</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d093667480369-3"><span class="crayon-h">    </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d093667480369-4"><span class="crayon-h">        </span><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">requests</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d093667480369-5"><span class="crayon-h">        </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-e">raise_for_status</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d093667480369-6"><span class="crayon-h">        </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">encoding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-e">apparent_encoding</span></div><div class="crayon-line" id="crayon-5bac8ede7d093667480369-7"><span class="crayon-e">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-e">text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d093667480369-8"><span class="crayon-e">    </span><span class="crayon-st">except</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d093667480369-9"><span class="crayon-h">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0018 seconds] -->
<p><span style="color: #ff0000"><strong>接下来是html代码解析程序</strong></span>，在这里首先需要解析的是东方财富网页面：<a href="http://quote.eastmoney.com/stocklist.html">链接描述</a>，我们打开其源代码，如下图所示：</p>
<p><a href="http://jbcdn2.b0.upaiyun.com/2017/08/c5866605d0bcdefdb66cb02ebcee5ea0.png"><img alt="134531uhe4siy48m1t4goo" class="aligncenter wp-image-88355 size-full" height="79" src="http://jbcdn2.b0.upaiyun.com/2017/08/c5866605d0bcdefdb66cb02ebcee5ea0.png" width="607"/></a></p>
<p>由上图可以看到，<span style="color: #ff0000"><strong>a</strong></span>标签的<span style="color: #ff0000"><strong>href</strong></span>属性中的网址链接里面有每只股票的对应的号码，因此我们只要把网址里面对应股票的号码解析出来即可。解析步骤如下：</p>
<p><strong>第一步，获得一个页面：</strong></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d09d466036512" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
html = getHTMLText(stockURL)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d09d466036512-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d09d466036512-1"><span class="crayon-v">html</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getHTMLText</span><span class="crayon-sy">(</span><span class="crayon-v">stockURL</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p><strong>第二步，解析页面，找到所有的a标签：</strong></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0a1981849322" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
soup = BeautifulSoup(html, 'html.parser') 
a = soup.find_all('a')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0a1981849322-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0a1981849322-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0a1981849322-1"><span class="crayon-v">soup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BeautifulSoup</span><span class="crayon-sy">(</span><span class="crayon-v">html</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'html.parser'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0a1981849322-2"><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">soup</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-s">'a'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p><strong>第三步，对<span style="color: #ff0000"><strong>a</strong></span>标签中的每一个进行遍历来进行相关的处理。处理过程如下：</strong></p>
<p>1.找到<span style="color: #ff0000"><strong>a</strong></span>标签中的<span style="color: #ff0000"><strong>href</strong></span>属性，并且判断属性中间的链接，把链接后面的数字取出来，在这里可以使用正则表达式来进行匹配。由于深圳交易所的代码以<span style="color: #ff0000"><strong>sz</strong></span>开头，上海交易所的代码以<span style="color: #ff0000"><strong>sh</strong></span>开头，股票的数字有<span style="color: #ff0000"><strong>6</strong></span>位构成，所以正则表达式可以写为<span style="color: #ff0000"><strong>[s][hz]\d{6}</strong></span>。也就是说构造一个正则表达式，在链接中去寻找满足这个正则表达式的字符串，并把它提取出来。代码如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0a5965866015" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
for i in a:
    href = i.attrs['href']
    lst.append(re.findall(r"[s][hz]\d{6}", href)[0])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0a5965866015-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0a5965866015-2">2</div><div class="crayon-num" data-line="crayon-5bac8ede7d0a5965866015-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0a5965866015-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0a5965866015-2"><span class="crayon-h">    </span><span class="crayon-v">href</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">.</span><span class="crayon-v">attrs</span><span class="crayon-sy">[</span><span class="crayon-s">'href'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bac8ede7d0a5965866015-3"><span class="crayon-h">    </span><span class="crayon-v">lst</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">re</span><span class="crayon-sy">.</span><span class="crayon-e">findall</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"[s][hz]\d{6}"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">href</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>2.由于在<span style="color: #ff0000"><strong>html</strong></span>中有很多的<span style="color: #ff0000"><strong>a</strong></span>标签，但是有些<span style="color: #ff0000"><strong>a</strong></span>标签中没有<span style="color: #ff0000"><strong>href</strong></span>属性，因此上述程序在运行的时候出现异常，所有对上述的程序还要进行<span style="color: #ff0000"><strong>try…except</strong></span>来对程序进行异常处理，代码如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0a9010278451" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
for i in a:
    try:
        href = i.attrs['href']
        lst.append(re.findall(r"[s][hz]\d{6}", href)[0])
    except:
        continue</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0a9010278451-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0a9010278451-2">2</div><div class="crayon-num" data-line="crayon-5bac8ede7d0a9010278451-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0a9010278451-4">4</div><div class="crayon-num" data-line="crayon-5bac8ede7d0a9010278451-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0a9010278451-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0a9010278451-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0a9010278451-2"><span class="crayon-h">    </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0a9010278451-3"><span class="crayon-h">        </span><span class="crayon-v">href</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">.</span><span class="crayon-v">attrs</span><span class="crayon-sy">[</span><span class="crayon-s">'href'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0a9010278451-4"><span class="crayon-h">        </span><span class="crayon-v">lst</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">re</span><span class="crayon-sy">.</span><span class="crayon-e">findall</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"[s][hz]\d{6}"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">href</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0a9010278451-5"><span class="crayon-h">    </span><span class="crayon-st">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0a9010278451-6"><span class="crayon-h">        </span><span class="crayon-st">continue</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>从上面代码可以看出，对于出现异常的情况我们使用了<span style="color: #ff0000"><strong>continue</strong></span>语句，直接让其跳过，继续执行下面的语句。通过上面的程序我们就可以把东方财富网上股票的代码信息全部保存下来了。</p>
<p><strong>将上述的代码封装成一个函数，对东方财富网页面解析的完整代码如下所示：</strong></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0ad444761738" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
def getStockList(lst, stockURL):
    html = getHTMLText(stockURL)
    soup = BeautifulSoup(html, 'html.parser') 
    a = soup.find_all('a')
    for i in a:
        try:
            href = i.attrs['href']
            lst.append(re.findall(r"[s][hz]\d{6}", href)[0])
        except:
            continue</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0ad444761738-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0ad444761738-2">2</div><div class="crayon-num" data-line="crayon-5bac8ede7d0ad444761738-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0ad444761738-4">4</div><div class="crayon-num" data-line="crayon-5bac8ede7d0ad444761738-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0ad444761738-6">6</div><div class="crayon-num" data-line="crayon-5bac8ede7d0ad444761738-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0ad444761738-8">8</div><div class="crayon-num" data-line="crayon-5bac8ede7d0ad444761738-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0ad444761738-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0ad444761738-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">getStockList</span><span class="crayon-sy">(</span><span class="crayon-v">lst</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stockURL</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0ad444761738-2"><span class="crayon-h">    </span><span class="crayon-v">html</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getHTMLText</span><span class="crayon-sy">(</span><span class="crayon-v">stockURL</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0ad444761738-3"><span class="crayon-h">    </span><span class="crayon-v">soup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BeautifulSoup</span><span class="crayon-sy">(</span><span class="crayon-v">html</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'html.parser'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0ad444761738-4"><span class="crayon-h">    </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">soup</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-s">'a'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0ad444761738-5"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0ad444761738-6"><span class="crayon-h">        </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0ad444761738-7"><span class="crayon-h">            </span><span class="crayon-v">href</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">.</span><span class="crayon-v">attrs</span><span class="crayon-sy">[</span><span class="crayon-s">'href'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0ad444761738-8"><span class="crayon-h">            </span><span class="crayon-v">lst</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">re</span><span class="crayon-sy">.</span><span class="crayon-e">findall</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"[s][hz]\d{6}"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">href</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0ad444761738-9"><span class="crayon-h">        </span><span class="crayon-st">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0ad444761738-10"><span class="crayon-h">            </span><span class="crayon-st">continue</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0025 seconds] -->
<p><strong>接下来是获得百度股票网<a href="https://gupiao.baidu.com/stock/sz300023.html">链接描述</a>单只股票的信息。</strong>我们先查看该页面的源代码，如下图所示：</p>
<p><a href="http://jbcdn2.b0.upaiyun.com/2017/08/7742e9536a095384a3b609d59b9d33c9.png"><img alt="134531uhe4siy48m1t4goo" class="aligncenter wp-image-88356 size-full" height="735" src="http://jbcdn2.b0.upaiyun.com/2017/08/7742e9536a095384a3b609d59b9d33c9.png" width="562"/></a></p>
<p>股票的信息就存在上图所示的html代码中，因此我们需要对这段html代码进行解析。过程如下：</p>
<p>1.百度股票网的网址为：<span style="color: #ff0000"><strong>https://gupiao.baidu.com/stock/</strong></span><br/>
一只股票信息的网址为：<span style="color: #ff0000"><strong>https://gupiao.baidu.com/stock/sz300023.html</strong></span></p>
<p>所以只要<span style="color: #ff0000"><strong>百度股票网的网址+每只股票的代码</strong></span>即可，而每只股票的代码我们已经有前面的程序<span style="color: #ff0000"><strong>getStockList</strong></span>从东方财富网解析出来了，因此对<span style="color: #ff0000"><strong>getStockList</strong></span>函数返回的列表进行遍历即可，代码如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0b2131696042" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
for stock in lst:
        url = stockURL + stock + ".html"</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0b2131696042-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0b2131696042-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0b2131696042-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">stock </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lst</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0b2131696042-2"><span class="crayon-h">        </span><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockURL</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">stock</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">".html"</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>2.获得网址后，就要访问网页获得网页的<span style="color: #ff0000"><strong>html</strong></span>代码了，程序如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0b5058453910" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
html = getHTMLText(url)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0b5058453910-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0b5058453910-1"><span class="crayon-v">html</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getHTMLText</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>3.获得了<span style="color: #ff0000"><strong>html</strong></span>代码后就需要对<span style="color: #ff0000"><strong>html</strong></span>代码进行解析，由上图我们可以看到单个股票的信息存放在标签为<span style="color: #ff0000"><strong>div</strong></span>,属性为<span style="color: #ff0000"><strong>stock-bets</strong></span>的<span style="color: #ff0000"><strong>html</strong></span>代码中，因此对其进行解析：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0b8571296979" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
soup = BeautifulSoup(html, 'html.parser')
stockInfo = soup.find('div',attrs={'class':'stock-bets'})</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0b8571296979-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0b8571296979-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0b8571296979-1"><span class="crayon-v">soup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BeautifulSoup</span><span class="crayon-sy">(</span><span class="crayon-v">html</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'html.parser'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0b8571296979-2"><span class="crayon-v">stockInfo</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">soup</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-s">'div'</span><span class="crayon-sy">,</span><span class="crayon-v">attrs</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">'class'</span><span class="crayon-o">:</span><span class="crayon-s">'stock-bets'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>4.我们又发现股票名称在<span style="color: #ff0000"><strong>bets-name</strong></span>标签内，继续解析，存入字典中：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0bb359235916" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
infoDict = {}
name = stockInfo.find_all(attrs={'class':'bets-name'})[0]
infoDict.update({'股票名称': name.text.split()[0]})</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0bb359235916-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0bb359235916-2">2</div><div class="crayon-num" data-line="crayon-5bac8ede7d0bb359235916-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0bb359235916-1"><span class="crayon-v">infoDict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0bb359235916-2"><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockInfo</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-v">attrs</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">'class'</span><span class="crayon-o">:</span><span class="crayon-s">'bets-name'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bac8ede7d0bb359235916-3"><span class="crayon-v">infoDict</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">'股票名称'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">.</span><span class="crayon-v">text</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0014 seconds] -->
<p><span style="color: #ff0000"><strong>split()</strong></span>的意思是股票名称空格后面的部分不需要了。</p>
<p>5.我们从<span style="color: #ff0000"><strong>html</strong></span>代码中还可以观察到股票的其他信息存放在<span style="color: #ff0000"><strong>dt</strong></span>和<span style="color: #ff0000"><strong>dd</strong></span>标签中，其中dt表示股票信息的键域，dd标签是值域。获取全部的键和值：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0bf693294495" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
keyList = stockInfo.find_all('dt')
valueList = stockInfo.find_all('dd')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0bf693294495-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0bf693294495-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0bf693294495-1"><span class="crayon-v">keyList</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockInfo</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-s">'dt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0bf693294495-2"><span class="crayon-v">valueList</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockInfo</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-s">'dd'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>并把获得的键和值按键值对的方式村放入字典中：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0c2930204797" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
for i in range(len(keyList)):
    key = keyList[i].text
    val = valueList[i].text
    infoDict[key] = val</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0c2930204797-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c2930204797-2">2</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c2930204797-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c2930204797-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0c2930204797-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">keyList</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c2930204797-2"><span class="crayon-h">    </span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">keyList</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">text</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c2930204797-3"><span class="crayon-e">    </span><span class="crayon-v">val</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">valueList</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c2930204797-4"><span class="crayon-e">    </span><span class="crayon-v">infoDict</span><span class="crayon-sy">[</span><span class="crayon-v">key</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">val</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>6.最后把字典中的数据存入外部文件中：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0c6763848621" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
with open(fpath, 'a', encoding='utf-8') as f:
f.write( str(infoDict) + '\n' )</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0c6763848621-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c6763848621-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0c6763848621-1"><span class="crayon-st">with</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">fpath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'a'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">encoding</span><span class="crayon-o">=</span><span class="crayon-s">'utf-8'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c6763848621-2"><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">infoDict</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'\n'</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p><strong>将上述过程封装成完成的函数，代码如下：</strong></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0c9657338875" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
def getStockInfo(lst, stockURL, fpath):
    for stock in lst:
        url = stockURL + stock + ".html"
        html = getHTMLText(url)
        try:
            if html=="":
                continue
            infoDict = {}
            soup = BeautifulSoup(html, 'html.parser')
            stockInfo = soup.find('div',attrs={'class':'stock-bets'})
 
            name = stockInfo.find_all(attrs={'class':'bets-name'})[0]
            infoDict.update({'股票名称': name.text.split()[0]})
             
            keyList = stockInfo.find_all('dt')
            valueList = stockInfo.find_all('dd')
            for i in range(len(keyList)):
                key = keyList[i].text
                val = valueList[i].text
                infoDict[key] = val
             
            with open(fpath, 'a', encoding='utf-8') as f:
                f.write( str(infoDict) + '\n' )
        except:
            continue</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-2">2</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-4">4</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-6">6</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-8">8</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-10">10</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-12">12</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-14">14</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-16">16</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-18">18</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-20">20</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-22">22</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0c9657338875-24">24</div><div class="crayon-num" data-line="crayon-5bac8ede7d0c9657338875-25">25</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">getStockInfo</span><span class="crayon-sy">(</span><span class="crayon-v">lst</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stockURL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fpath</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-2"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">stock </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lst</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-3"><span class="crayon-h">        </span><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockURL</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">stock</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">".html"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-4"><span class="crayon-h">        </span><span class="crayon-v">html</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getHTMLText</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-5"><span class="crayon-h">        </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-6"><span class="crayon-h">            </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">html</span><span class="crayon-o">==</span><span class="crayon-s">""</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-7"><span class="crayon-h">                </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-8"><span class="crayon-h">            </span><span class="crayon-v">infoDict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-9"><span class="crayon-h">            </span><span class="crayon-v">soup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BeautifulSoup</span><span class="crayon-sy">(</span><span class="crayon-v">html</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'html.parser'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-10"><span class="crayon-h">            </span><span class="crayon-v">stockInfo</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">soup</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-s">'div'</span><span class="crayon-sy">,</span><span class="crayon-v">attrs</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">'class'</span><span class="crayon-o">:</span><span class="crayon-s">'stock-bets'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-11"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-12"><span class="crayon-h">            </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockInfo</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-v">attrs</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">'class'</span><span class="crayon-o">:</span><span class="crayon-s">'bets-name'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-13"><span class="crayon-h">            </span><span class="crayon-v">infoDict</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">'股票名称'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">.</span><span class="crayon-v">text</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-14"><span class="crayon-h">             </span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-15"><span class="crayon-h">            </span><span class="crayon-v">keyList</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockInfo</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-s">'dt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-16"><span class="crayon-h">            </span><span class="crayon-v">valueList</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockInfo</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-s">'dd'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-17"><span class="crayon-h">            </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">keyList</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-18"><span class="crayon-h">                </span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">keyList</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">text</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-19"><span class="crayon-e">                </span><span class="crayon-v">val</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">valueList</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-20"><span class="crayon-e">                </span><span class="crayon-v">infoDict</span><span class="crayon-sy">[</span><span class="crayon-v">key</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">val</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-21"><span class="crayon-e">             </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-22"><span class="crayon-e">            </span><span class="crayon-st">with</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">fpath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'a'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">encoding</span><span class="crayon-o">=</span><span class="crayon-s">'utf-8'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-23"><span class="crayon-h">                </span><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">infoDict</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'\n'</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0c9657338875-24"><span class="crayon-h">        </span><span class="crayon-st">except</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0c9657338875-25"><span class="crayon-h">            </span><span class="crayon-st">continue</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0062 seconds] -->
<p>其中<span style="color: #ff0000"><strong>try…except</strong></span>用于异常处理。</p>
<p><strong>接下来编写主函数，调用上述函数即可：</strong></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0cd319127187" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
def main():
    stock_list_url = 'http://quote.eastmoney.com/stocklist.html'
    stock_info_url = 'https://gupiao.baidu.com/stock/'
    output_file = 'D:/BaiduStockInfo.txt'
    slist=[]
    getStockList(slist, stock_list_url)
    getStockInfo(slist, stock_info_url, output_file)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0cd319127187-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0cd319127187-2">2</div><div class="crayon-num" data-line="crayon-5bac8ede7d0cd319127187-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0cd319127187-4">4</div><div class="crayon-num" data-line="crayon-5bac8ede7d0cd319127187-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0cd319127187-6">6</div><div class="crayon-num" data-line="crayon-5bac8ede7d0cd319127187-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0cd319127187-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0cd319127187-2"><span class="crayon-h">    </span><span class="crayon-v">stock_list_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'http://quote.eastmoney.com/stocklist.html'</span></div><div class="crayon-line" id="crayon-5bac8ede7d0cd319127187-3"><span class="crayon-h">    </span><span class="crayon-v">stock_info_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'https://gupiao.baidu.com/stock/'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0cd319127187-4"><span class="crayon-h">    </span><span class="crayon-v">output_file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'D:/BaiduStockInfo.txt'</span></div><div class="crayon-line" id="crayon-5bac8ede7d0cd319127187-5"><span class="crayon-h">    </span><span class="crayon-v">slist</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0cd319127187-6"><span class="crayon-h">    </span><span class="crayon-e">getStockList</span><span class="crayon-sy">(</span><span class="crayon-v">slist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stock_list_url</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0cd319127187-7"><span class="crayon-h">    </span><span class="crayon-e">getStockInfo</span><span class="crayon-sy">(</span><span class="crayon-v">slist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stock_info_url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">output_file</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p></p>
<h1>项目完整程序</h1>
<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" id="crayon-5bac8ede7d0d0598056253" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;" wrap="soft">
# -*- coding: utf-8 -*-

import requests
from bs4 import BeautifulSoup
import traceback
import re
 
def getHTMLText(url):
    try:
        r = requests.get(url)
        r.raise_for_status()
        r.encoding = r.apparent_encoding
        return r.text
    except:
        return ""
 
def getStockList(lst, stockURL):
    html = getHTMLText(stockURL)
    soup = BeautifulSoup(html, 'html.parser') 
    a = soup.find_all('a')
    for i in a:
        try:
            href = i.attrs['href']
            lst.append(re.findall(r"[s][hz]\d{6}", href)[0])
        except:
            continue
 
def getStockInfo(lst, stockURL, fpath):
    count = 0
    for stock in lst:
        url = stockURL + stock + ".html"
        html = getHTMLText(url)
        try:
            if html=="":
                continue
            infoDict = {}
            soup = BeautifulSoup(html, 'html.parser')
            stockInfo = soup.find('div',attrs={'class':'stock-bets'})
 
            name = stockInfo.find_all(attrs={'class':'bets-name'})[0]
            infoDict.update({'股票名称': name.text.split()[0]})
             
            keyList = stockInfo.find_all('dt')
            valueList = stockInfo.find_all('dd')
            for i in range(len(keyList)):
                key = keyList[i].text
                val = valueList[i].text
                infoDict[key] = val
             
            with open(fpath, 'a', encoding='utf-8') as f:
                f.write( str(infoDict) + '\n' )
                count = count + 1
                print("\r当前进度: {:.2f}%".format(count*100/len(lst)),end="")
        except:
            count = count + 1
            print("\r当前进度: {:.2f}%".format(count*100/len(lst)),end="")
            continue
 
def main():
    stock_list_url = 'http://quote.eastmoney.com/stocklist.html'
    stock_info_url = 'https://gupiao.baidu.com/stock/'
    output_file = 'D:/BaiduStockInfo.txt'
    slist=[]
    getStockList(slist, stock_list_url)
    getStockInfo(slist, stock_info_url, output_file)
 
main()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-2">2</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-4">4</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-6">6</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-8">8</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-10">10</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-12">12</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-14">14</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-16">16</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-18">18</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-20">20</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-22">22</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-24">24</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-26">26</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-28">28</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-30">30</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-32">32</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-34">34</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-36">36</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-38">38</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-40">40</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-42">42</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-44">44</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-46">46</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-48">48</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-50">50</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-52">52</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-54">54</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-56">56</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-58">58</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-60">60</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-62">62</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-64">64</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bac8ede7d0d0598056253-66">66</div><div class="crayon-num" data-line="crayon-5bac8ede7d0d0598056253-67">67</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-1"><span class="crayon-c"># -*- coding: utf-8 -*-</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-2"> </div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">requests</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-4"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">bs4 </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">BeautifulSoup</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">traceback</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">re</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-7"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-8"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">getHTMLText</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-9"><span class="crayon-h">    </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-10"><span class="crayon-h">        </span><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">requests</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-11"><span class="crayon-h">        </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-e">raise_for_status</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-12"><span class="crayon-h">        </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">encoding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-e">apparent_encoding</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-13"><span class="crayon-e">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-e">text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-14"><span class="crayon-e">    </span><span class="crayon-st">except</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-15"><span class="crayon-h">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-16"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-17"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">getStockList</span><span class="crayon-sy">(</span><span class="crayon-v">lst</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stockURL</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-18"><span class="crayon-h">    </span><span class="crayon-v">html</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getHTMLText</span><span class="crayon-sy">(</span><span class="crayon-v">stockURL</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-19"><span class="crayon-h">    </span><span class="crayon-v">soup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BeautifulSoup</span><span class="crayon-sy">(</span><span class="crayon-v">html</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'html.parser'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-20"><span class="crayon-h">    </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">soup</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-s">'a'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-21"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-22"><span class="crayon-h">        </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-23"><span class="crayon-h">            </span><span class="crayon-v">href</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">.</span><span class="crayon-v">attrs</span><span class="crayon-sy">[</span><span class="crayon-s">'href'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-24"><span class="crayon-h">            </span><span class="crayon-v">lst</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">re</span><span class="crayon-sy">.</span><span class="crayon-e">findall</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"[s][hz]\d{6}"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">href</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-25"><span class="crayon-h">        </span><span class="crayon-st">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-26"><span class="crayon-h">            </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-27"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-28"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">getStockInfo</span><span class="crayon-sy">(</span><span class="crayon-v">lst</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stockURL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fpath</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-29"><span class="crayon-h">    </span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-30"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">stock </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lst</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-31"><span class="crayon-h">        </span><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockURL</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">stock</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">".html"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-32"><span class="crayon-h">        </span><span class="crayon-v">html</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getHTMLText</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-33"><span class="crayon-h">        </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-34"><span class="crayon-h">            </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">html</span><span class="crayon-o">==</span><span class="crayon-s">""</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-35"><span class="crayon-h">                </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-36"><span class="crayon-h">            </span><span class="crayon-v">infoDict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-37"><span class="crayon-h">            </span><span class="crayon-v">soup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BeautifulSoup</span><span class="crayon-sy">(</span><span class="crayon-v">html</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'html.parser'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-38"><span class="crayon-h">            </span><span class="crayon-v">stockInfo</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">soup</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-s">'div'</span><span class="crayon-sy">,</span><span class="crayon-v">attrs</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">'class'</span><span class="crayon-o">:</span><span class="crayon-s">'stock-bets'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-39"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-40"><span class="crayon-h">            </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockInfo</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-v">attrs</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">'class'</span><span class="crayon-o">:</span><span class="crayon-s">'bets-name'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-41"><span class="crayon-h">            </span><span class="crayon-v">infoDict</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">'股票名称'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">.</span><span class="crayon-v">text</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-42"><span class="crayon-h">             </span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-43"><span class="crayon-h">            </span><span class="crayon-v">keyList</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockInfo</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-s">'dt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-44"><span class="crayon-h">            </span><span class="crayon-v">valueList</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stockInfo</span><span class="crayon-sy">.</span><span class="crayon-e">find_all</span><span class="crayon-sy">(</span><span class="crayon-s">'dd'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-45"><span class="crayon-h">            </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">keyList</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-46"><span class="crayon-h">                </span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">keyList</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">text</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-47"><span class="crayon-e">                </span><span class="crayon-v">val</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">valueList</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-48"><span class="crayon-e">                </span><span class="crayon-v">infoDict</span><span class="crayon-sy">[</span><span class="crayon-v">key</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">val</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-49"><span class="crayon-e">             </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-50"><span class="crayon-e">            </span><span class="crayon-st">with</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">fpath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'a'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">encoding</span><span class="crayon-o">=</span><span class="crayon-s">'utf-8'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-51"><span class="crayon-h">                </span><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">infoDict</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'\n'</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-52"><span class="crayon-h">                </span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-53"><span class="crayon-h">                </span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"\r当前进度: {:.2f}%"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">count</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-o">/</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">lst</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">end</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-54"><span class="crayon-h">        </span><span class="crayon-st">except</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-55"><span class="crayon-h">            </span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-56"><span class="crayon-h">            </span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"\r当前进度: {:.2f}%"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">count</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-o">/</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">lst</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">end</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-57"><span class="crayon-h">            </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-58"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-59"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-60"><span class="crayon-h">    </span><span class="crayon-v">stock_list_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'http://quote.eastmoney.com/stocklist.html'</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-61"><span class="crayon-h">    </span><span class="crayon-v">stock_info_url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'https://gupiao.baidu.com/stock/'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-62"><span class="crayon-h">    </span><span class="crayon-v">output_file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'D:/BaiduStockInfo.txt'</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-63"><span class="crayon-h">    </span><span class="crayon-v">slist</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-64"><span class="crayon-h">    </span><span class="crayon-e">getStockList</span><span class="crayon-sy">(</span><span class="crayon-v">slist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stock_list_url</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-65"><span class="crayon-h">    </span><span class="crayon-e">getStockInfo</span><span class="crayon-sy">(</span><span class="crayon-v">slist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stock_info_url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">output_file</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bac8ede7d0d0598056253-66"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5bac8ede7d0d0598056253-67"><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0188 seconds] -->
<p><strong>上述代码中的<span style="color: #ff0000"><strong>print</strong></span>语句用于打印爬取的进度。执行完上述代码后在<span style="color: #ff0000"><strong>D盘</strong></span>会出现<span style="color: #ff0000"><strong>BaiduStockInfo.txt</strong></span>文件，里面存放了股票的信息。</strong></p>
<div class="post-adds">
<span class=" btn-bluet-bigger href-style vote-post-up register-user-only " data-post-id="88350"><i class="fa fa-thumbs-o-up"></i> <h10 id="88350votetotal">2</h10> 赞</span>
<span class=" btn-bluet-bigger href-style bookmark-btn register-user-only " data-book-type="1" data-item-id="88350" data-item-type="1" data-site-id="13"><i class="fa fa-bookmark-o "></i> 16 收藏</span>
<a href="#article-comment"><span class="btn-bluet-bigger href-style hide-on-480"><i class="fa fa-comments-o"></i> 5 评论</span></a>
<!-- JiaThis Button BEGIN -->
<div class="jiathis_style_24x24" style="display: inline-flex; position: relative; margin: 0; clear: both;float: right;">
<a class="jiathis_button_tsina"></a>
<a class="jiathis_button_weixin"></a>
<a class="jiathis_button_qzone"></a>
<a class="jiathis_button_fb hide-on-480"></a>
<a class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" href="http://www.jiathis.com/share?uid=1745061" target="_blank"></a>
</div>
</div>
<!-- BEGIN #author-bio -->
<!-- END #author-bio -->
</div>
            </body></html>