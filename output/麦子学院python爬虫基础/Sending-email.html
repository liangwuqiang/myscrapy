<!DOCTYPE html>
        <html><head><meta charset="UTF-8">
        </head><body>
        <p><center><h1>Sending-email</h1></center></p>
            <div class="cont">
<h1>Sending-email</h1>
<p><p><br/></p><h3><span style="color: rgb(94, 207, 186);"></span></h3><hr/><h3><span style="color: rgb(94, 207, 186);">基本使用方法</span><br/></h3><p><span style="color: rgb(94, 207, 186);"><br/></span></p><p>There are two ways to instantiate the mail sender. You can instantiate it using the standard constructor:</p><p>from scrapy.mail import MailSender</p><p> </p><p>mailer = MailSender()</p><p>Or you can instantiate it passing a Scrapy settings object, which will respect the settings:</p><p>mailer = MailSender.from_settings(settings)</p><p>And here is how to use it to send an e-mail (without attachments):</p><p>mailer.send(to=["someone@example.com"], subject="Some subject", body="Some body",  cc=["another@examp</p><p> </p><h3><span style="color: rgb(94, 207, 186);"></span></h3><hr/><h3><span style="color: rgb(94, 207, 186);">MailSender 类介绍</span><br/></h3><p><span style="color: rgb(94, 207, 186);"><br/></span></p><p>MailSender is the preferred class to use for sending emails from Scrapy, as it uses Twisted non-blocking IO, like the rest of the framework.</p><p> </p><p>Class scrapy.mail.MailSender(smtphost=None, mailfrom=None, smtpuser=None, smtppass=None, smtpport=None)</p><p> </p><p>Parameters</p><p><strong>•smtphost (str)</strong> </p><p><br/></p><p>– the SMTP host to use for sending the emails. If omitted, the MAIL_HOST setting will be used.</p><p> </p><p><strong>•mailfrom (str)</strong> </p><p><br/></p><p>– the address used to send emails (in the From: header). If omitted, the MAIL_FROM setting will be used.</p><p> </p><p><strong>•smtpuser</strong> </p><p><br/></p><p>– the SMTP user. If omitted, the MAIL_USER setting will be used. If not given, no SMTP authentication will be performed.</p><p> </p><p><strong>•smtppass (str) </strong></p><p><strong><br/></strong></p><p>– the SMTP pass for authentication.</p><p> </p><p><strong>•smtpport (int)</strong> </p><p><br/></p><p>– the SMTP port to connect to</p><p> </p><p><strong>•smtptls (boolean)</strong> </p><p><br/></p><p>– enforce using SMTP STARTTLS</p><p> </p><p><strong>•smtpssl (boolean) </strong></p><p><strong><br/></strong></p><p>– enforce using a secure SSL connection</p><p> </p><p>classmethod from_settings(settings)</p><p> </p><p>Instantiate using a Scrapy settings object, which will respect these Scrapy settings.</p><p> </p><p>Parameters settings (scrapy.settings.Settings object) – the e-mail recipients</p><p> </p><p>send(to, subject, body, cc=None, attachs=(), mimetype=’text/plain’)</p><p> </p><p>Send email to the given recipients.</p><p> </p><p>Parameters</p><p> </p><p><strong>to (list)</strong> </p><p><br/></p><p>– the e-mail recipients</p><p> </p><p><strong>subject (str)</strong> </p><p><br/></p><p>– the subject of the e-mail</p><p> </p><p><strong>cc (list)</strong> </p><p><br/></p><p>– the e-mails to CC</p><p> </p><p><strong>body (str)</strong> </p><p><br/></p><p>– the e-mail body</p><p> </p><p><strong>attachs (iterable)</strong> </p><p><br/></p><p>– an iterable of tuples (attach_name, mimetype, file_object) where attach_name is a string with the name that will ap-pear on the e-mail’s attachment, mimetype is the mimetype of the attachment and file_object is a readable file object with the contents of the attachment</p><p> </p><p><strong>mimetype (str)</strong></p><p><strong><br/></strong></p><p>– the MIME type of the e-mail</p><p> </p><h3><span style="color: rgb(94, 207, 186);"></span></h3><hr/><h3><span style="color: rgb(94, 207, 186);">Mail settings</span><br/></h3><p><span style="color: rgb(94, 207, 186);"><br/></span></p><p>These settings define the default constructor values of the MailSender class, and can be used to configure e-mail notifications in your project without writing any code (for those extensions and code that uses MailSender).</p><p><br/></p><p><strong>MAIL_FROM</strong></p><p> </p><p>Default: ’scrapy@localhost’</p><p>Sender email to use (From: header) for sending emails.</p><p>  </p><p><strong>MAIL_HOST</strong></p><p> </p><p>Default: ’localhost’</p><p>SMTP host to use for sending emails.</p><p> </p><p><strong>MAIL_PORT</strong></p><p> </p><p>Default: 25 </p><p>SMTP port to use for sending emails.</p><p> </p><p><strong>MAIL_USER</strong></p><p> </p><p>Default: None</p><p>User to use for SMTP authentication. If disabled no SMTP authentication will be performed.</p><p> </p><p><strong>MAIL_PASS</strong></p><p> </p><p>Default: None </p><p>Password to use for SMTP authentication, along with MAIL_USER.</p><p> </p><p><strong>MAIL_TLS</strong></p><p> </p><p>Default: False</p><p>Enforce using STARTTLS. STARTTLS is a way to take an existing insecure connection, and upgrade it to a secure connection using SSL/TLS.</p><p> </p><p><strong>MAIL_SSL</strong></p><p> </p><p>Default: False</p><p>Enforce connecting using an SSL encrypted connection</p><p> </p><h3><span style="color: rgb(94, 207, 186);"></span></h3><hr/><h3><span style="color: rgb(94, 207, 186);">总结</span><br/></h3><p><span style="color: rgb(94, 207, 186);"><br/></span></p><p>1，掌握logging模块的基本用法，以及在scrapy中的使用方法；</p><p>2，了解状态收集器基本操作和功能；</p><p>3，学会使用scrapy的mail模块发送邮件；</p><p> </p><h3><span style="color: rgb(94, 207, 186);"></span></h3><hr/><h3><span style="color: rgb(94, 207, 186);">作业</span></h3><p><br/></p><p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: normal;">在上节课项目制作的基础上，添加发送邮件的功能：当spider关闭时，邮件通知领导，并在邮件正文中添加spider的状态信息：</p><p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: normal;"> </p><p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: normal;"><strong>提示：</strong></p><p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: normal;"><br/></p><p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: normal;">1、可以在setting.py中配置邮件的相关参数；</p><p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: normal;">2、需要重写spider的dosed方法；</p><p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: normal;">3、需要读取crawler的状态信息，并且添加在正文中；</p><p> <br/></p><p><br/></p><p><span style='color: rgb(192, 0, 0); font-family: "microsoft yahei"; font-weight: bold; line-height: 20px; background-color: rgb(255, 255, 255);'>【本文由麦子学院独家原创，转载请注明出处并保留原文链接】</span></p><p>
</p></p></div>
        </body></html>